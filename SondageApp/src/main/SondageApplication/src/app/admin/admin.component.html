<div class="row">
  <div class="col-md-8">
    <h4>Liste Sondage</h4>
  </div>
  <div class="col-md-4">
    <a data-toggle="modal" data-target="#BlockComp" class="btn btn-success" (click)="nouveauSondage()">Nouveau Sondage</a>
  </div>
</div>

<div *ngIf="isSondage && !edit" class="alert alert-success">
  Le sondage a été créé avec succès!
</div>
<div *ngIf="isSondage && edit" class="alert alert-success">
  Le sondage a été modifié avec succès!
</div>

<div class="row">
  <table>
    <tr>
      <th>Nom</th>
      <th>Description</th>
      <th>Lieux</th>
      <th>Dates</th>
      <th>Actions</th>
    </tr>
    <tr *ngFor="let sondage of sondages">
      <td>{{sondage.titre}}</td>
      <td>{{sondage.description}}</td>
      <td>
        <p *ngFor="let lieu of sondage.lieux">
          {{lieu}}
        </p>
      </td>
      <td>
        <p *ngFor="let date of sondage.dates">
          {{date}}
        </p>
      </td>
      <td>
        <button class="btn btn-default btn-rounded btn-sm" data-toggle="modal" data-target="#BlockComp"
                (click)="editSondage(sondage)">
          <span class="fa fa-pencil"></span></button>
        <button class="btn btn-danger btn-rounded btn-sm" mwlConfirmationPopover
                [popoverTitle]="popoverTitle" [popoverMessage]="popoverMessage" placement="left"
                (confirm)="deleteSondage(sondage)">
          <span class="fa fa-times"></span>
        </button>
      </td>
    </tr>
  </table>
</div>


  <!-- MODALS -->
  <div id="BlockComp" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="taskEditModalHead"
       aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span
            class="sr-only">Fermer</span></button>
          <h4 class="modal-title" id="taskEditModalHead">{{model_title}}</h4>
        </div>
        <form class="form-horizontal" [formGroup]="form" (ngSubmit)="f.form.valid && onSubmit()" #f="ngForm" novalidate>
          <div class="modal-body">
            <div class="form-group col-md-12">
              <label for="titre">Titre du Sondage</label>
              <input type="text" class="form-control" formControlName="titre"required />
            </div>
            <div class="form-group col-md-12">
              <label for="description">Description</label>
              <input type="text" class="form-control" formControlName="description" required />
            </div>
            <div formArrayName="lieux">
              <label for="lieux">Lieux </label>
              <button type="button" (click)="deleteLieu(lieuIndex)" class="btn btn-danger btn-rounded btn-sm">
                <span class="fa fa-minus"></span></button>
              <button type="button" (click)="addLieu()" class="btn btn-success btn-rounded btn-sm">
                <span class="fa fa-plus"></span></button>
              <div *ngFor="let item of lieux.controls; let lieuIndex=index" [formGroupName]="lieuIndex">
                <label for="lieux">Lieu {{lieuIndex + 1}}</label>
                <input type="text" class="form-control" formControlName="lieu" required />
              </div>
            </div><br>
            <div formArrayName="dates">
              <label for="dates">Dates</label>
              <button type="button" (click)="deleteDate(dateIndex)" class="btn btn-danger btn-rounded btn-sm">
                <span class="fa fa-minus"></span></button>
              <button type="button" (click)="addDate()" class="btn btn-success btn-rounded btn-sm">
                <span class="fa fa-plus"></span></button>
              <div *ngFor="let item of dates.controls; let dateIndex=index" [formGroupName]="dateIndex">
                <label for="dates">Date {{dateIndex + 1}}</label>
                <input type="date" class="form-control" formControlName="date" required />
              </div>
            </div><br>
            <div class="form-group">
              <div *ngIf="f.submitted && isSondageFailed" class="alert alert-warning">
                Création sondage a échouée!<br/>{{errorMessage}}
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="submit" class="btn btn-primary">Save changes</button>
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  <!-- END MODALS -->


